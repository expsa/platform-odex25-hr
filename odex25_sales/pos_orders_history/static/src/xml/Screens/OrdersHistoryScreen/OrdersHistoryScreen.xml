<?xml version="1.0" encoding="utf-8"?>
<templates id="template" xml:space="preserve">
    <t t-name="OrdersHistoryScreen" owl="1">
            <div class="ticket-screen screen">
                <div class="screen-content">
                    <div class="controls">
                        <div class="buttons">
                            <button class="discard" t-on-click="trigger('close-screen')">
                                <i class='fa fa-angle-double-left' />
                                Back
                            </button>
                            <span t-if="env.pos.config.load_barcode_order_only" class="button scan-barcode" t-on-click="scanBarcode">Scan Barcode</span>
                        </div>
                        <t t-set="placeholder">Search Orders...</t>
                        <SearchBar config="searchBarConfig" placeholder="placeholder" />
                    </div>
                    <div class="orders">
                        <div class='header-row'>
                            <div class="col start wide">Order Ref</div>
                            <div class="col start">Customer</div>
                            <div class="col start wide">POS</div>
                            <div class="col start wide">Order Date</div>
                            <div class="col start">Salesman</div>
                            <div class="col start narrow">Status</div>
                            <div class="col center very-narrow actions oe_hidden">Actions</div>
                        </div>
                        <t t-foreach="orders" t-as="order" t-key="order.cid">
                            <div class='order-row pointer' t-on-click="ev => this.lineSelect(ev)">
                                <div class='col start wide'>
                                    <t t-esc='order.pos_reference' />
                                </div>
                                <div class="col start">
                                    <t t-if='order.partner_id' t-esc='order.partner_id[1]' />
                                    <t t-if='!order.partner_id' t-esc='""' />
                                </div>
                                <div class="col start wide">
                                    <t t-esc='order.pos_name' />
                                </div>
                                <div class="col start wide">
                                    <t t-esc='get_datetime_format(order.date_order)' />
                                </div>
                                <div class="col start">
                                    <t t-esc="order.user_id[1] || ''" />
                                </div>
                                <t
                                    t-set="state"
                                    t-value="order.computed_state &amp;&amp; order.computed_state || order.state"
                                />
                                <div class="col start narrow">
                                    <t t-if="state == 'done'">
                                        Posted
                                    </t>
                                    <t t-if="state == 'paid'">
                                        Paid
                                    </t>
                                    <t t-if="state == 'cancel'">
                                        Cancelled
                                    </t>
                                    <t t-if="state == 'invoiced'">
                                        Invoiced
                                    </t>
                                </div>
                                <div class="actions oe_hidden">
                                </div>
                            </div>
                            <div class="line-element-hidden line-element-container">
                                    <div class="orders">
                                        <div class="header-row">
                                            <div class="col center start">Image</div>
                                            <div class="col start wide">Product</div>
                                            <div class="col end">Quantity</div>
                                            <div class="col end">Unit Price</div>
                                            <div class="col end">Discount</div>
                                            <div class="col end">Subtotal w/o Tax</div>
                                            <div class="col end">Subtotal</div>
                                        </div>
                                        <t t-foreach="order.lines" t-as="id" t-key="id">
                                            <t t-set="line" t-value="env.pos.db.line_by_id[id] || {}"/>
                                            <div class='order-row pointer'>
                                                <div class="col center line-image">
                                                    <img t-att-src="line.image" />
                                                </div>
                                                <div class="col start wide">
                                                    <t t-esc='line.product_id[1]' />
                                                </div>
                                                <div class="col end">
                                                    <t t-esc='line.qty' />
                                                </div>
                                                <div class="col end">
                                                    <t t-esc='env.pos.format_currency(line.price_unit)' />
                                                </div>
                                                <div class="col end">
                                                    <t t-esc="line.discount || 0.0" />
                                                </div>
                                                <div class="col end">
                                                    <t t-esc='env.pos.format_currency(line.price_subtotal)' />
                                                </div>
                                                <div class="col end">
                                                    <t t-esc='env.pos.format_currency(line.price_subtotal_incl)' />
                                                </div>
                                            </div>
                                        </t>
                                    </div>
                            </div>
                        </t> 
                    </div>
                </div>
            </div>
        </t>
    </templates>
